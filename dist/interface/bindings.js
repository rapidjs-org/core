/**
 * rapidJS: Automatic serving, all-implicit-routing, pluggable fullstack scoped
 *          function modules, un-opinionated templating. 
 * 
 * Copyright (c) Thassilo Martin Schiepanski
 */
"use strict";var __createBinding=this&&this.__createBinding||(Object.create?function(e,t,n,i){void 0===i&&(i=n),Object.defineProperty(e,i,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,i){e[i=void 0===i?n:i]=t[n]}),__setModuleDefault=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),__importStar=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&__createBinding(t,e,n);return __setModuleDefault(t,e),t};Object.defineProperty(exports,"__esModule",{value:!0}),exports.bindLocale=exports.bindSSR=exports.localeEngine=exports.ssrEngine=void 0;const output=__importStar(require("../utilities/output"));class RenderBinding{constructor(e,t=1/0){this.length=0,this.caption=e,this.limit=t,this.engineStore=[]}bind(e,t){if(this.engineStore.length>=this.limit)throw new ReferenceError(`Trying to bind more ${this.caption} engines than allowed (max. ${this.limit}).`);this.length++,this.engineStore.push({callback:e,implicitReadingOnly:t})}apply(t,n,i){return this.engineStore.filter(e=>!!i||!e.implicitReadingOnly).forEach(e=>{try{"string"!=typeof(t=e.callback[0].apply(null,[require("../interface/scope:common"),t].concat(n)))&&output.error(new SyntaxError(`Render of ${this.caption} engine is not a string, but has been stringified (check result)`))}catch(e){output.log(`An error occurred applying ${this.caption} rendering engine:`),output.error(e)}}),t}}function bindSSR(...e){return exports.ssrEngine.bind.call(exports.ssrEngine,e)}function bindLocale(...e){return exports.localeEngine.bind.call(exports.localeEngine,e)}exports.ssrEngine=new RenderBinding("SSR"),exports.localeEngine=new RenderBinding("locale",1),exports.bindSSR=bindSSR,exports.bindLocale=bindLocale;